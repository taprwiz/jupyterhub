version: '3'

services:
  proxy:
      env_file:
        - auth_token.env
      image: jupyter/configurable-http-proxy
      networks:
        - jupyterhub
    # override entrypoint to expose api to the network
      entrypoint:
        - "configurable-http-proxy"
        - "--api-ip=0.0.0.0"
        - "--api-port=8001"

  hub:
      depends_on:
        - proxy
      env_file:
        - auth_token.env
      image: python:3.6.3-alpine3.6
      networks:
        - jupyterhub
      command: "python -m http.server"
      volumes:
        - ./:/home/jupyterhub

networks:
  jupyterhub:
